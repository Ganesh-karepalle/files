var apexMonacoEditor=function(e){"use strict";var t,n,a={featureDetails:{name:"APEX-VS-Monaco-Editor",scriptVersion:"1.0.2.2",utilVersion:"1.6",url:"https://github.com/RonnyWeiss",url2:"https://linktr.ee/ronny.weiss",license:"MIT-License"},isDefinedAndNotNull:function(e){return null!=e&&""!=e},loader:{start:function(t,n){n&&$(t).css("min-height","100px"),e.util.showSpinner($(t))},stop:function(e,t){t&&$(e).css("min-height",""),$(e+" > .u-Processing").remove(),$(e+" > .ct-loader").remove()}},splitString2Array:function(t){if(null!=t&&""!=t&&t.length>0){if(e&&e.server&&e.server.chunk)return e.server.chunk(t);var n,a=8e3,r=[];if(t.length>a){for(r=[],n=0;n<t.length;)r.push(t.substr(n,a)),n+=a;return r}return r.push(t),r}return[]}};function r(t,n){var r=t.items2Submit;a.loader.start(t.regionSel);var i=a.splitString2Array(n);e.debug.info({fct:a.featureDetails.name+" - uploadFiles",msg:"Upload started!",strArr:i,featureDetails:a.featureDetails}),e.server.plugin(t.ajaxID,{x01:"POST",f01:i,pageItems:r},{success:function(n){$(t.regionIDRefreshSel).trigger("upload-finished"),e.message.showPageSuccess("File saved!"),e.debug.info({fct:a.featureDetails.name+" - uploadFiles",msg:"Upload finished!",pData:n,featureDetails:a.featureDetails}),a.loader.stop(t.regionSel)},error:function(n,r,i){$(t.regionIDRefreshSel).trigger("upload-error"),e.debug.error({fct:a.featureDetails.name+" - uploadFiles",msg:"Upload error!",jqXHR:n,textStatus:r,errorThrown:i,featureDetails:a.featureDetails}),a.loader.stop(t.regionSel),e.event.trigger(pOpts.affElementID,"imageuploaderror")}})}function i(e,a,r,i){var o=document.getElementById(e.regionID);if(r){var s=monaco.editor.createModel(a,e.language),d=monaco.editor.createModel(i,e.language),l=a!==i;t=monaco.editor.createDiffEditor(o,{originalEditable:!e.readOnly,readOnly:!0,language:e.language,theme:e.theme,automaticLayout:!0,renderSideBySide:l}),document.getElementById(n).editor=t,document.getElementById(n).originalModel=s,document.getElementById(n).modifiedModel=d,t.setModel({original:s,modified:d})}else t=monaco.editor.create(o,{value:a,language:e.language,theme:e.theme,automaticLayout:!0,readOnly:e.readOnly}),document.getElementById(n).editor=t}function o(e){var t=$("<div></div>");t.addClass("apex-vs-monaco-editor-toolbar-container-btn"),t.addClass("a-Button");var n=$("<span></span>");return n.addClass("fas fa-md"),n.addClass(e),n.addClass("apex-vs-monaco-editor-toolbar-container-btn-icon"),t.append(n),t}function s(e,n,a,s){var d=!1,l=a;if(e.buttonsStr&&e.buttonsStr.length>0){var u=$("<div></div>");if(u.addClass("apex-vs-monaco-editor-toolbar-container"),u.css("border-bottom","1px solid rgba(0,0,0,0.075)"),e.buttons.indexOf("undo")>-1){var g=o("fa-solid fa-rotate-left");g.on("click",(function(){l?t.getOriginalEditor().getModel().undo():t.getModel().undo()})),u.append(g)}if(e.buttons.indexOf("redo")>-1){var c=o("fa-solid fa-rotate-right");c.on("click",(function(){l?t.getOriginalEditor().getModel().redo():t.getModel().redo()})),u.append(c)}if(e.buttons.indexOf("search")>-1){var f=o("fa-search");f.on("click",(function(){(d=!d)?l?(t.getOriginalEditor().getAction("actions.find").run(),t.getModifiedEditor().getAction("actions.find").run()):t.getAction("actions.find").run():l?(t.getOriginalEditor().trigger("keyboard","closeFindWidget"),t.getModifiedEditor().trigger("keyboard","closeFindWidget")):t.trigger("keyboard","closeFindWidget")})),u.append(f)}if(e.buttons.indexOf("diff")>-1){var p=function(e,t){var n=$("<div></div>");n.addClass("apex-vs-monaco-editor-toolbar-container-btn"),n.addClass("a-Button");var a=$("<span></span>");return a.attr("id",t),a.addClass("fas fa-md"),a.addClass(e),a.addClass("apex-vs-monaco-editor-toolbar-container-btn-icon"),n.append(a),n}("fa-solid fa-eye ","previewBtn");p.on("click",(function(){var n;if(d=!1,l=!l){n=t.getValue();const e=document.querySelector(".apex-monaco-editor-container");e&&(e.style.height="auto");const a=marked.marked(n),r=document.getElementById("preview");r&&(r.style.display="block",r.innerHTML=a),document.getElementById("previewBtn").classList.remove("fa-eye"),document.getElementById("previewBtn").classList.add("fa-edit")}else{n=t.getModel().original.getValue();const e=document.querySelector(".apex-monaco-editor-container");e&&(e.style.height="100vh");const a=document.querySelector("#preview");a&&(a.style.display="none"),document.getElementById("previewBtn").classList.add("fa-eye"),document.getElementById("previewBtn").classList.remove("fa-edit")}t.dispose(),i(e,n,l,s)})),u.append(p)}if(e.buttons.indexOf("save")>-1){var m=o("fa-save save-button");m.on("click",(function(){var n;n=l?t.getModel().original.getValue():t.getValue(),r(e,n)})),u.append(m)}$(e.regionSel).prepend(u)}$(e.regionIDRefreshSel).on("save",(function(){var n;n=l?t.getModel().original.getValue():t.getValue(),r(e,n)}))}function d(t){var n=t.items2Submit;a.loader.start(t.regionSel),e.server.plugin(t.ajaxID,{pageItems:n,x01:"GET"},{success:function(n){e.debug.info({fct:a.featureDetails.name+" - getData",ajaxResponse:n,featureDetails:a.featureDetails}),function(e,t){var n,r,o=!1;a.isDefinedAndNotNull(e)&&a.isDefinedAndNotNull(e.rows)&&a.isDefinedAndNotNull(e.rows[0])&&(a.isDefinedAndNotNull(e.rows[0].VALUE_EDIT)&&(n=e.rows[0].VALUE_EDIT),a.isDefinedAndNotNull(e.rows[0].VALUE_DIFF)?(r=e.rows[0].VALUE_DIFF,o=!1):r=n,a.isDefinedAndNotNull(e.rows[0].LANGUAGE)&&(t.language=e.rows[0].LANGUAGE)),require.config({paths:{vs:t.path}}),require(["vs/editor/editor.main"],(function(){i(t,n,o,r),s(t,0,o,r),a.loader.stop(t.regionSel),$(t.regionIDRefreshSel).trigger("rendered")}))}(n,t)},error:function(n){e.debug.error({fct:a.featureDetails.name+" - getData",ajaxResponse:n,featureDetails:a.featureDetails}),a.loader.stop(t.regionSel)},dataType:"json"})}return{initialize:function(r,i,o,s,l,u,g,c,f,p){e.debug.info({fct:a.featureDetails.name+" - initialize",arguments:{pRegionID:r,pRegionIDRefresh:i,pAjaxID:o,pItems2Submit:s,pPath:l,pHeight:u,pLanguage:g,pTheme:c,pButtons:f},featureDetails:a.featureDetails}),n=r;var m={};return m.buttons=f.split(":"),m.buttonsStr=f,m.height=u||"50vh",m.language=g||"plaintext",m.theme=c||"vs-dark",m.regionID=r,m.regionSel="#"+r,m.regionIDRefresh=i,m.regionIDRefreshSel="#"+i,m.path=l,m.ajaxID=o,m.readOnly=p,m.items2Submit=s,$(m.regionSel).height(m.height),$(m.regionSel).css("border","1px solid rgba(0,0,0,0.075)"),$(m.regionSel).css("overflow","hidden"),d(m),t}}};